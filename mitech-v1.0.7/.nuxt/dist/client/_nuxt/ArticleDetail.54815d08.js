import{_ as U}from"./Header.460fa155.js";import{_ as W}from"./Breadcrumbs.18353780.js";import{_ as Q,v as F,E as X,b as Z,d as tt,e as et,f as M,h as z,i as ot,j as st,k as B,l as nt,m as at}from"./entry.0cdb93ce.js";import{b as O,s as H,a as lt,g as L,c as g,d as T}from"./state.4da28978.js";import{S as it}from"./ServiceItemStyleTwo.3e2c5f83.js";import{aJ as S,$ as a,a0 as c,a1 as t,ak as _,n as i,af as d,aM as P,aN as j,ag as R,ae as A,F as b,as as w,aj as y,ai as C,P as N,U as ct}from"./_plugin-vue_export-helper.2c3522c3.js";import{a as k}from"./axios.28bc18a3.js";import{_ as dt}from"./el-overlay.538533c5.js";/* empty css             *//* empty css                  */import{_ as rt}from"./CtaThree.25177853.js";import{_ as E}from"./Footer.c5032859.js";import{_ as G}from"./OffCanvasMobileMenu.b67ad2ce.js";/* empty css               */import"./index.3c6563bf.js";import{_ as _t,a as mt}from"./reply-comm.a19715a4.js";import{_ as Y}from"./ChatBot.85e95aeb.js";import{P as pt}from"./PageHeader.12d22828.js";import"./HeaderTop.fc351d8a.js";import"./cta.4c436c57.js";/* empty css                                */const ht={components:{ServiceItemStyleTwo:it},props:{title:{type:String},other:{type:String},id:{type:Number},url:{type:String}},methods:{handle(){O().value=this.url,H()}}},q=o=>(P("data-v-90ebe4c4"),o=o(),j(),o),ut={class:"content"},ft={class:"ht-box-icon style-02 single-svg-icon-box"},vt={class:"icon-box-wrap"},kt={class:"content"},yt={class:"heading"},gt={class:"text"},bt={class:"feature-btn"},Ct=q(()=>t("span",{class:"button-text"},"Discover now",-1)),wt=q(()=>t("i",{class:"fas fa-arrow-right ms-1"},null,-1));function xt(o,e,s,m,n,r){const f=Q;return a(),c("div",ut,[t("div",ft,[t("div",vt,[t("div",kt,[t("h5",yt,_(s.title),1),t("div",gt,_(s.other),1),t("div",bt,[i(f,{to:`/paper-check/${s.id}`,onClick:e[0]||(e[0]=x=>r.handle())},{default:d(()=>[Ct,wt]),_:1},8,["to"])])])])])])}const $t=S(ht,[["render",xt],["__scopeId","data-v-90ebe4c4"]]);const It={props:{openalex_id:{type:String},title:{type:String},cited_by_count:{type:Number}},data(){return{uploadUrl:"http://121.36.19.201/api/analysis/create",title_analysis:""}},methods:{async uploadFile(o){console.log("upload file");const e={"Content-Type":"multipart/form-data",Authorization:"token "+lt().value};try{const s=new FormData;s.append("file",o),s.append("openalex_id",this.openalex_id),s.append("title_analysis",this.title_analysis),s.append("title",this.title),s.append("cited_by_count",this.cited_by_count);const m=await k.post(this.uploadUrl,s,{headers:e});console.log("File uploaded successfully:",m.data),this.title_analysis=""}catch(s){console.error("File upload failed:",s)}},triggerFileInput(){this.$refs.fileInput.click()},handleFileChange(o){const e=o.target.files[0];e&&this.uploadFile(e)}},mounted(){L(),console.log(this.$props)}},At=o=>(P("data-v-5dabfebb"),o=o(),j(),o),Tt=At(()=>t("h6",null," Analysis Title:",-1));function St(o,e,s,m,n,r){return a(),c("div",null,[Tt,R(t("input",{class:"a-input",type:"text","onUpdate:modelValue":e[0]||(e[0]=f=>n.title_analysis=f)},null,512),[[F,n.title_analysis]]),t("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:e[1]||(e[1]=(...f)=>r.handleFileChange&&r.handleFileChange(...f))},null,544),t("button",{class:"btn",onClick:e[2]||(e[2]=(...f)=>r.triggerFileInput&&r.triggerFileInput(...f))},"Upload md File")])}const Ft=S(It,[["render",St],["__scopeId","data-v-5dabfebb"]]);const Rt={data(){return{activeNames:[],checkList:[]}},methods:{test(){console.log(this.collection)},gotoDetail(o){console.log(o),g().value="https://openalex.org/"+o.open_alex_id,T().value=o.display_name,H(),location.reload()},addCollect(){for(let o of this.checkList)console.log(o),o.articles.works.push({work:{id:g().value,display_name:T().value,open_alex_id:"W"+g().value.split("W")[1]}});this.checkList=[]},stopCollapse(o){return o.stopPropagation()},isDisable(o){var e=!1;for(let s of o)console.log(g().value,s.id),g().value==s.id&&(e=!0);return e},removeWork(o,e){e.articles.works=e.articles.works.filter(n=>n!==o);var s={"Content-Type":"application/json",Authorization:"Token "+this.token},m={work_id:o.work.id};k.post("http://121.36.19.201/api/removeCollectionItem/",m,{headers:s}).then(n=>{console.log(n)}).catch(n=>{console.log(n)})}},mounted(){z.on("confirm",()=>{this.addCollect()})}},Vt=Object.assign(Rt,{__name:"CollectionPlane",props:["collection","token"],setup(o){return(e,s)=>{const m=ot,n=X,r=st,f=B,x=Z,$=tt,I=et;return a(),A(I,{modelValue:e.activeNames,"onUpdate:modelValue":s[2]||(s[2]=p=>e.activeNames=p),onChange:e.handleChange},{default:d(()=>[i($,{modelValue:e.checkList,"onUpdate:modelValue":s[1]||(s[1]=p=>e.checkList=p)},{default:d(()=>[(a(!0),c(b,null,w(o.collection,p=>(a(),A(x,{name:p.id},{title:d(()=>[i(r,null,{default:d(()=>[i(m,{span:20,class:"name"},{default:d(()=>[y(_(p.name),1)]),_:2},1024),i(m,{span:4,class:"check"},{default:d(()=>[i(n,{label:p,onClick:e.stopCollapse,disable:e.isDisable(p.articles.works),class:"fuck"},null,8,["label","onClick","disable"])]),_:2},1024)]),_:2},1024)]),default:d(()=>[p.articles.works.length+p.articles.analysis.length<=0?(a(),A(r,{key:0,class:"mid"},{default:d(()=>[y("(空)")]),_:1})):C("",!0),(a(!0),c(b,null,w(p.articles.works,v=>(a(),A(r,{class:"item"},{default:d(()=>[i(m,{span:20,class:"title",onClick:V=>e.gotoDetail(v.work)},{default:d(()=>[y(_((v.work.display_name?v.work.display_name:"NULL")+" ("+v.work.open_alex_id+")"),1)]),_:2},1032,["onClick"]),i(m,{span:4},{default:d(()=>[i(f,{type:"danger",icon:N(M),onClick:V=>e.removeWork(v,p),class:"delete-button"},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024))),256)),(a(!0),c(b,null,w(p.articles.analysis,v=>(a(),A(r,{class:"item"},{default:d(()=>[i(m,{span:20},{default:d(()=>[y(_(v.analysis.display_name),1)]),_:2},1024),i(m,{span:4,class:"title"},{default:d(()=>[i(f,{type:"danger",icon:N(M),onClick:s[0]||(s[0]=()=>{}),class:"delete-button"},null,8,["icon"])]),_:1})]),_:2},1024))),256))]),_:2},1032,["name"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","onChange"])}}}),Dt=S(Vt,[["__scopeId","data-v-19ef1b0d"]]);const Nt={components:{Header:U,Breadcrumbs:W,CtaThree:rt,Footer:E,OffCanvasMobileMenu:G,CollectionPlane:Dt},data(){return{drawer2:!1,citedCount:0,replyToCommentId:null,newReplyText:"",token:"",detailInfo:{title:"",author:"",date:"",viewnumber:"",commentCount:0,abstract:"",_keywords:[],keywords:[]},collections:[],relatedArticileAnalyse:[],newCommentText:" ",work_id:"",article_id:"",comments:[],authorList:[],isOa:!1,oa_url:""}},methods:{cancelClick(){drawer2.value=!1},confirmClick(){z.emit("confirm"),this.drawer2=!1},showReplyForm(o){o.visible=!0;var e=o.id;this.replyToCommentId=e},change2Md(o){O().value=o.file_url,this.$router.push("/markdowndisplay")},fetchArticle(){var o={single_object_id:this.$data.article_id};k.post("http://121.36.19.201/api/get_works/",o).then(e=>{this.$data.detailInfo.title=e.data.title,this.$data.detailInfo.date=e.data.publication_date,this.$data.detailInfo.author=e.data.authorships[0].author.display_name,this.$data.detailInfo.keywords=e.data.keywords,this.$data.detailInfo.abstract=e.data.abstract,this.$data.isOa=e.data.open_access.is_oa,this.$data.oa_url=e.data.open_access.oa_url,this.$data.citedCount=e.data.cited_by_count;for(var s=0;s<e.data.keywords.length;s++)this.$data.detailInfo._keywords.push(e.data.keywords[s].keyword);for(var s=0;s<e.data.authorships.length;s++)this.$data.authorList.push({name:e.data.authorships[s].author.display_name,pos:e.data.authorships[s].author_position})}).catch(e=>{console.log(e)})},fetchAnalyse(){console.log(g().value),k({method:"post",data:{work_id:g().value},url:"http://121.36.19.201/api/work/getana"}).then(o=>{console.log(o),this.$data.relatedArticileAnalyse=o.data,console.log("fetch analysis access")}).catch(o=>{console.log(o),console.log("fetchAnalyse Error")})},fetchComments(){var o={"Content-Type":"application/json",Authorization:"Token "+this.$data.token};k.get("http://121.36.19.201/api/get_comment_on_work/"+this.$data.article_id,{headers:o}).then(e=>{this.$data.comments=e.data;for(var s=0;s<this.$data.comments.length;s++)this.fetchSubCommments(o,s);this.$data.detailInfo.commentCount=this.$data.comments.length}).catch(e=>{console.log(e)})},fetchSubCommments(o,e){k.get("http://121.36.19.201/api/get_comment_on_comment/"+this.$data.comments[e].id,{headers:o}).then(s=>{this.$data.comments[e].commentsReply=[],this.$data.comments[e].commentsReply.push(s.data)}).catch(s=>{console.log(s)})},addComment(){var o={"Content-Type":"application/json",Authorization:"Token "+this.$data.token},e={openalex_id:this.$data.article_id,data:this.$data.newCommentText};this.$data.newCommentText="",k.post("http://121.36.19.201/api/comment_on_work/",e,{headers:o}).then(s=>{}).catch(s=>{console.log(s)})},addReply(o){o.visible=!1;var e=o.father?o.father.id:o.id;console.log(e);var s={"Content-Type":"application/json",Authorization:"Token "+this.$data.token},m={comment_id:e,data:this.$data.newReplyText};this.$data.newReplyText="",console.log(m),k.post("http://121.36.19.201/api/comment_on_comment/",m,{headers:s}).then(n=>{console.log(n.data)}).catch(n=>{console.log(n)}),this.fetchComments()},fetchCollections(){if(this.token){var o={"Content-Type":"application/json",Authorization:"Token "+this.token};k.get("http://121.36.19.201/api/getCollectionPackage/",{headers:o}).then(e=>{console.log(e),this.$data.collections=e.data;for(let s of e.data)this.fetchUnderCollection(s)}).catch(e=>{console.log(e)})}},fetchUnderCollection(o){var e={"Content-Type":"application/json",Authorization:"Token "+this.token};k.get("http://121.36.19.201/api/getCollectionPackageContents/"+o.id,{headers:e}).then(s=>{console.log(s),o.articles=s.data}).catch(s=>{console.log(s)})}},mounted(){L(),this.$data.token="f55807b7e70689d2a6756521a3b8375b2531d3d9",this.$data.work_id=g().value,this.$data.article_id="W"+this.$data.work_id.split("W")[1],console.log(this.$data.work_id,this.$data.article_id),this.fetchComments(),this.fetchAnalyse(),this.fetchArticle(),this.fetchCollections()}},u=o=>(P("data-v-3442ae08"),o=o(),j(),o),Ut={class:"main-container"},Lt={class:"blog-pages-wrapper section-space--ptb_50"},Pt={class:"container"},jt={class:"row"},Et={class:"col-lg-20 ms-auto me-auto",style:{"padding-left":"60px","border-left":"2px solid","padding-right":"60px","border-right":"2px solid"}},Mt={class:"main-blog-wrap"},Wt={class:"single-blog-item wow move-up"},zt={class:"post-info lg-blog-post-info"},Bt={key:0,class:"post-title text-center"},Ot=["href"],Ht={key:1,class:"post-title text-center"},Gt={class:"post-meta mt-30 justify-content-center"},Yt={class:"post-date"},qt=u(()=>t("span",{class:"far fa-calendar meta-icon"},null,-1)),Jt={class:"post-comments"},Kt=u(()=>t("span",{class:"far fa-comment-alt meta-icon"},null,-1)),Qt={href:"#comment",class:"smooth-scroll-link"},Xt={key:0,class:"post-view"},Zt=u(()=>t("span",{class:"meta-icon far fa-folder"},null,-1)),te={class:"post-excerpt mt-30"},ee={style:{"font-size":"20px"}},oe=u(()=>t("br",null,null,-1)),se=u(()=>t("br",null,null,-1)),ne=u(()=>t("h4",{class:"widget-title section-space--mb_50"}," Abstract: ",-1)),ae={class:"p1"},le=u(()=>t("h4",{class:"widget-title section-space--mb_50"}," Author Infomation: ",-1)),ie={class:"post-author"},ce={key:0,style:{"font-weight":"bold","font-size":"20px"}},de={key:1,style:{"font-size":"20px"}},re=u(()=>t("h4",{class:"widget-title section-space--mb_50"},[t("br"),y(" Article Analyses: "),t("br")],-1)),_e=u(()=>t("h4",{class:"widget-title section-space--mb_50"},[t("br"),t("br"),y(" Share your Analyses about this article ")],-1)),me={key:0},pe={class:"entry-post-share-wrap border-bottom"},he={class:"row align-items-center"},ue=u(()=>t("div",{class:"col-lg-12 col-md-12"},null,-1)),fe={class:"comment-list-wrapper"},ve={class:"row"},ke=u(()=>t("div",{class:"col-lg-12"},[t("h4",{class:"widget-title section-space--mb_50",id:"comment"},"Comments： ")],-1)),ye={class:"col-lg-12"},ge={class:"comment-list"},be={class:"comment"},Ce={class:"comment-5"},we=u(()=>t("div",{class:"comment-author vcard"},[t("img",{alt:"",src:_t})],-1)),xe={class:"comment-content"},$e={class:"meta"},Ie={class:"fn"},Ae={class:"comment-datetime"},Te={class:"comment-text"},Se={class:"comment-actions"},Fe=["onClick"],Re={key:0},Ve=["onClick"],De={class:"children"},Ne={class:"comment"},Ue={class:"comment-6"},Le=u(()=>t("div",{class:"comment-author vcard"},[t("img",{alt:"",src:mt})],-1)),Pe={class:"comment-content"},je={class:"meta"},Ee={class:"fn"},Me={class:"comment-datetime"},We={class:"comment-text"},ze={class:"comment-actions"},Be=["onClick"],Oe={key:0},He=["onClick"],Ge={class:"comment-list-wrapper"},Ye={class:"row"},qe=u(()=>t("div",{class:"col-lg-12"},[t("h4",{class:"widget-title mb-20"},"Share Your Idea About The Article: "),t("p",null,"Add your commment. ")],-1)),Je={class:"col-lg-12"},Ke={class:"contact-from-wrapper section-space--mt_30"},Qe={action:"#",method:"post"},Xe={class:"contact-page-form"},Ze={class:"contact-inner contact-message"},to={class:"comment-submit-btn text-center"},eo=u(()=>t("h4",null,"Collections",-1)),oo={style:{flex:"auto"}};function so(o,e,s,m,n,r){const f=W,x=$t,$=Ft,I=nt,p=ct("CollectionPlane"),v=B,V=at,K=dt;return a(),c(b,null,[t("div",Ut,[i(f,{items:"Article Details",breadcrumbTitle:"文献详情"}),t("div",Lt,[t("div",Pt,[t("div",jt,[t("div",Et,[t("div",Mt,[t("div",Wt,[t("div",zt,[n.isOa?(a(),c("h3",Bt,[t("a",{href:n.oa_url},_(n.detailInfo.title),9,Ot)])):C("",!0),n.isOa?C("",!0):(a(),c("h3",Ht,_(n.detailInfo.title),1)),t("div",Gt,[t("div",Yt,[qt,y(" "+_(n.detailInfo.date),1)]),t("div",Jt,[Kt,t("a",Qt,_(n.detailInfo.commentCount)+" Comments",1)]),n.token?(a(),c("div",Xt,[Zt,t("a",{herf:"#",class:"smooth-scroll-link",onClick:e[0]||(e[0]=l=>n.drawer2=!0)}," Collect ")])):C("",!0)]),t("div",te,[t("span",ee,[y(" keywords : "+_(Array.from(n.detailInfo._keywords).join(", "))+" ",1),oe,se]),ne,t("blockquote",null,[t("p",ae,_(n.detailInfo.abstract),1)]),le,t("div",ie,[(a(!0),c(b,null,w(n.authorList,(l,h)=>(a(),c("div",{key:h,class:"inline"},[h===0?(a(),c("span",ce,_(l.name),1)):(a(),c("span",de," , "+_(l.name),1))]))),128))]),re,(a(!0),c(b,null,w(n.relatedArticileAnalyse,l=>(a(),c("span",{key:l.id},[i(x,{title:l.title,other:l.username,id:l.id,url:l.file_url,class:"CardClass"},null,8,["title","other","id","url"])]))),128)),_e,n.work_id?(a(),c("div",me,[i($,{openalex_id:n.work_id,title:n.detailInfo.title,cited_by_count:n.citedCount},null,8,["openalex_id","title","cited_by_count"])])):C("",!0),t("div",pe,[t("div",he,[ue,t("div",fe,[t("div",ve,[ke,(a(!0),c(b,null,w(n.comments,l=>(a(),c("div",{key:l.id},[t("div",ye,[t("ol",ge,[t("li",be,[t("div",Ce,[we,t("div",xe,[t("div",$e,[t("h6",Ie,_(l.user.username),1),t("div",Ae,_(l.created_time),1)]),t("div",Te,[t("p",null,_(l.content),1)]),t("div",Se,[t("button",{class:"comment-reply-link",onClick:h=>r.showReplyForm(l)},"Reply",8,Fe),l.visible?(a(),c("div",Re,[R(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>n.newReplyText=h)},null,512),[[F,n.newReplyText]]),t("button",{onClick:h=>r.addReply(l),class:"submit"},"Submit Reply",8,Ve)])):C("",!0)])])]),t("ol",De,[(a(!0),c(b,null,w(l.commentsReply[0],h=>(a(),c("div",{class:"",key:h.id},[t("li",Ne,[t("div",Ue,[Le,t("div",Pe,[t("div",je,[t("h6",Ee,_(h.user.username)+"@"+_(h.father.user.username),1),t("div",Me,_(h.created_time),1)]),t("div",We,[t("p",null,_(h.content),1)]),t("div",ze,[t("button",{class:"comment-reply-link",onClick:D=>r.showReplyForm(h)},"Reply",8,Be),h.visible?(a(),c("div",Oe,[R(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=D=>n.newReplyText=D)},null,512),[[F,n.newReplyText]]),t("button",{onClick:D=>r.addReply(h),class:"button"},"Submit Reply",8,He)])):C("",!0)])])])])]))),128))])])])])]))),128))])]),t("div",Ge,[t("div",Ye,[qe,t("div",Je,[t("div",Ke,[t("form",Qe,[t("div",Xe,[t("div",Ze,[R(t("textarea",{name:"comment",placeholder:"Your Comment","onUpdate:modelValue":e[3]||(e[3]=l=>n.newCommentText=l)},null,512),[[F,n.newCommentText]])]),t("div",to,[t("button",{class:"button",onClick:e[4]||(e[4]=l=>r.addComment())},"Submit")])])])])])])])])])])])])])])])])])]),i(K,null,{default:d(()=>[i(V,{modelValue:n.drawer2,"onUpdate:modelValue":e[7]||(e[7]=l=>n.drawer2=l)},{header:d(()=>[eo,i(I)]),default:d(()=>[t("div",null,[i(p,{collection:n.collections,token:n.token},null,8,["collection","token"])])]),footer:d(()=>[t("div",oo,[i(v,{onClick:e[5]||(e[5]=l=>r.cancelClick())},{default:d(()=>[y("cancel")]),_:1}),i(v,{type:"primary",onClick:e[6]||(e[6]=l=>r.confirmClick())},{default:d(()=>[y("confirm")]),_:1})])]),_:1},8,["modelValue"])]),_:1})],64)}const J=S(Nt,[["render",so],["__scopeId","data-v-3442ae08"]]),no={name:"articledetail",components:{ArticleMainContent:J,Header:U,PageHeader:pt,Footer:E,OffCanvasMobileMenu:G,ChatBot:Y},mounted(){L(),console.log(T().value)},data(){return{WorkName:T().value}},head(){return{title:"Ariticle Detail",meta:[{hid:"description",name:"description",content:"About our description"}]}}},ao={class:"main-container"};function lo(o,e,s,m,n,r){const f=U,x=J,$=Y,I=E;return a(),c("div",ao,[i(f),i(x),i($,{prompt:("useWorkName"in o?o.useWorkName:N(T))().value+","},null,8,["prompt"]),i(I)])}const So=S(no,[["render",lo]]);export{So as default};
