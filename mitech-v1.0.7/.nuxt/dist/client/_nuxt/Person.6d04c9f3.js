import{_ as E}from"./Header.460fa155.js";import{t as K,x as Y,A as Q,q as W,B as X,C as Z,D as $,s as ee,F as oe,G as te,H as le,I as ne,J as se,_ as A,K as ae}from"./entry.0cdb93ce.js";import{_ as ie}from"./el-overlay.538533c5.js";import{_ as S}from"./Footer.c5032859.js";/* empty css             *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                */import{_ as re}from"./authentication.849d26eb.js";/* empty css                *//* empty css                 *//* empty css                */import{g as ue,a as f,i as de,s as _e}from"./state.4da28978.js";import{_ as me}from"./OffCanvasMobileMenu.b67ad2ce.js";import{a as b}from"./axios.28bc18a3.js";import{_ as ce}from"./defaultavatar.37b16ac5.js";import{aJ as pe,a0 as g,n as o,a1 as n,af as l,ak as I,ai as P,$ as c,ag as F,ae as U,F as fe,as as he,ac as be,U as h,aE as ge,aM as ve,aN as we}from"./_plugin-vue_export-helper.2c3522c3.js";import"./HeaderTop.fc351d8a.js";/* empty css                                */const Ve=K();for(const[a,e]of Object.entries(Y))Ve.vueApp.component(a,e);const ye={components:{Header:E,Footer:S,OffCanvasMobileMenu:me},name:"Person",data(){return{dialogVisible:!1,dialogVisible_new:!1,user:{id:Number,password:"",username:"",first_name:"",last_name:"",email:"",phone_number:"",gender:"",description:"",avatar_url:"",work_count:Number,is_professional:Number,open_alex_id_author:""},new_collection:{name:""},rules_1:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],email:[{required:!0,message:"E-mail不能为空",trigger:"blur"}]},rules_2:{name:[{required:!0,message:"文件夹名字不能为空",trigger:"blur"}]},collection:[]}},mounted(){ue(),console.log("Token"),console.log(f().value),this.load(),this.load_collection()},methods:{async load(){const a={"Content-Type":"application/json",Authorization:"token "+f().value};await b.get("http://121.36.19.201/api/info/",{headers:a}).then(e=>{console.log(e.data),this.user.id=e.data.id,this.user.username=e.data.username,this.user.first_name=e.data.first_name,this.user.last_name=e.data.last_name,this.user.email=e.data.email,this.user.phone_number=e.data.phone_number,this.user.gender=e.data.gender,this.user.description=e.data.description,this.user.avatar_url=e.data.avatar_url,this.user.work_count=e.data.work_count,this.user.is_professional=e.data.is_professional,this.user.open_alex_id_author=e.data.open_alex_id_author}).catch(e=>{console.log(e)})},async load_collection(){const a={"Content-Type":"application/json",Authorization:"token "+f().value};await b.get("http://121.36.19.201/api/getCollectionPackage/",{headers:a}).then(e=>{this.collection=e.data,console.log(e.data)}).catch(e=>{console.log(e)})},edit(){this.dialogVisible=!0},async submit(){const a={"Content-Type":"application/json",Authorization:"token "+f().value},e={phone_number:this.user.phone_number,gender:this.user.gender,description:this.user.description,email:this.user.email};await b.post("http://121.36.19.201/api/editinfo/",e,{headers:a}).then(r=>{console.log(r.data)}).catch(r=>{console.log(r)}),this.dialogVisible=!1},handleClose(){this.dialogVisible=!1},createCollection(){this.dialogVisible_new=!0},async submit_new(){const a={"Content-Type":"application/json",Authorization:"token "+f().value},e={name:this.new_collection.name};data=await b.post("http://121.36.19.201/api/createCollectionPackage/",e,{headers:a}).then(r=>{console.log(r.data),this.load_collection(),this.dialogVisible_new=!1}).catch(r=>{console.log(r)})},handleClose_new(){this.dialogVisible_new=!1},modify(){console.log("点击了"),document.querySelector('input[type="file"]').click()},uploadImage(a){const e=a.target.files[0];e===void 0?console.log("undefined"):(console.log("马上提交"),this.submitImg(e))},async submitImg(a){console.log("提交中");const e={"Content-Type":"multipart/form-data",Authorization:"token "+f().value},r={image:a};console.log(r.image),await b.post("http://121.36.19.201/api/uploadimage/",r,{headers:e}).then(v=>{console.log(v.data),this.load()}).catch(v=>{console.log(v)})},storeSCIid(){var a=de();a.value=this.user.open_alex_id_author,_e()}}},d=a=>(ve("data-v-878c5b08"),a=a(),we(),a),Ce={class:"main-container"},xe={class:"PersonTop"},ke={class:"hover-shadow"},Ae={key:0,src:ce},Ie=["src"],Pe={class:"PersonTop_text"},Fe={class:"user_text"},Ue={class:"user_name"},Ee={key:0,class:"user-v"},Se=d(()=>n("img",{src:re,class:"user-v-img"},null,-1)),Ne=d(()=>n("span",{class:"user-v-font"},"科研工作者",-1)),De=[Se,Ne],Me={class:"hero-button mt-30"},ze={class:"person_body"},Te={class:"person_body_left"},Le=d(()=>n("div",{slot:"header",class:"clearfix"},[n("span",{class:"person_body_list",style:{"border-bottom":"none"}},"Personal Center")],-1)),je=d(()=>n("span",{slot:"title"},"切换至科研门户",-1)),qe=d(()=>n("span",{slot:"title"},"Profile",-1)),Be=d(()=>n("span",{slot:"title"},"History",-1)),He=d(()=>n("span",{slot:"title"},"Follow List",-1)),Oe=d(()=>n("span",{slot:"title"},"Favorite",-1)),Ge={slot:"title"},Je=d(()=>n("span",{slot:"title"},"Create new Favorite",-1)),Re={class:"person_body_right"},Ke={class:"updateinfo"},Ye={class:"left"},Qe={class:"right"},We={slot:"footer",class:"dialog-footer"},Xe={class:"updateinfo"},Ze={slot:"footer",class:"dialog-footer"};function $e(a,e,r,v,s,i){const N=E,D=Q,M=h("Switch"),m=W,z=A,p=X,T=h("UserFilled"),w=A,L=h("Document"),j=h("User"),V=h("Folder"),q=h("Plus"),B=Z,H=$,O=ee,G=ae,_=oe,u=te,J=le,y=ne,C=se,x=ie,R=S,k=ge("image-preview");return c(),g("div",Ce,[o(N),n("div",null,[n("div",xe,[o(D,{width:"220","confirm-button-text":"Yes","cancel-button-text":"No,thanks",icon:a.InfoFilled,"icon-color":"#626AEF",title:"你要修改头像吗?",style:{"font-size":"30px"},onConfirm:i.modify},{reference:l(()=>[n("div",ke,[s.user.avatar_url==""?F((c(),g("img",Ae,null,512)),[[k]]):F((c(),g("img",{key:1,src:s.user.avatar_url},null,8,Ie)),[[k]]),n("input",{type:"file",style:{display:"none"},onChange:e[0]||(e[0]=(...t)=>i.uploadImage&&i.uploadImage(...t)),accept:"image/*"},null,32)])]),_:1},8,["icon","onConfirm"]),n("div",Pe,[n("div",Fe,[n("div",Ue,[n("span",null,I(s.user.username),1)]),s.user.open_alex_id_author!=""?(c(),g("div",Ee,De)):P("",!0),n("div",Me,[n("button",{class:"ht-btn ht-btm-md",onClick:e[1]||(e[1]=(...t)=>i.edit&&i.edit(...t))},"Modify Personal Info")])])])]),n("div",ze,[n("div",Te,[o(O,{class:"box-card","body-style":{padding:"0px"}},{default:l(()=>[Le,o(H,{"active-text-color":"#00c3ff",class:"el-menu-vertical-demo",style:{overflow:"auto","max-height":"500px"}},{default:l(()=>[s.user.open_alex_id_author!=""?(c(),U(p,{key:0},{default:l(()=>[o(z,{to:"/scientist",onClick:e[2]||(e[2]=t=>i.storeSCIid())},{default:l(()=>[o(m,null,{default:l(()=>[o(M)]),_:1}),je]),_:1})]),_:1})):P("",!0),o(p,null,{default:l(()=>[o(w,{to:"/person/info"},{default:l(()=>[o(m,null,{default:l(()=>[o(T)]),_:1}),qe]),_:1})]),_:1}),o(p,null,{default:l(()=>[o(w,{to:"/person/history"},{default:l(()=>[o(m,null,{default:l(()=>[o(L)]),_:1}),Be]),_:1})]),_:1}),o(p,null,{default:l(()=>[o(w,{to:"/person/myfollow"},{default:l(()=>[o(m,null,{default:l(()=>[o(j)]),_:1}),He]),_:1})]),_:1}),o(B,{onClick:a.open,style:{"padding-top":"20px"}},{title:l(()=>[o(m,null,{default:l(()=>[o(V)]),_:1}),Oe]),default:l(()=>[(c(!0),g(fe,null,he(s.collection,t=>(c(),U(p,be({key:t.id},t),{default:l(()=>[o(w,{to:`/person/mycollection-${t.id}`},{default:l(()=>[o(m,null,{default:l(()=>[o(V)]),_:1}),n("span",Ge,I(t.name),1)]),_:2},1032,["to"])]),_:2},1040))),128)),o(p,{onClick:i.createCollection},{default:l(()=>[o(m,null,{default:l(()=>[o(q)]),_:1}),Je]),_:1},8,["onClick"])]),_:1},8,["onClick"])]),_:1})]),_:1})]),n("div",Re,[o(G)])])]),o(x,null,{default:l(()=>[o(C,{title:"Modify Personal Info",modelValue:s.dialogVisible,"onUpdate:modelValue":e[13]||(e[13]=t=>s.dialogVisible=t),width:"60%","before-close":i.handleClose,draggable:""},{default:l(()=>[o(y,{model:s.user,rules:s.rules_1,ref:"user","label-width":"150px",size:"large"},{default:l(()=>[n("div",Ke,[n("div",Ye,[o(u,{label:"User_name",prop:"username"},{default:l(()=>[o(_,{modelValue:s.user.username,"onUpdate:modelValue":e[3]||(e[3]=t=>s.user.username=t),placeholder:"User_name",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{label:"Last_name",prop:"last_name"},{default:l(()=>[o(_,{modelValue:s.user.last_name,"onUpdate:modelValue":e[4]||(e[4]=t=>s.user.last_name=t),placeholder:"Last_name",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{label:"First_name",prop:"first_name"},{default:l(()=>[o(_,{modelValue:s.user.first_name,"onUpdate:modelValue":e[5]||(e[5]=t=>s.user.first_name=t),placeholder:"First_name",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{label:"Gender",prop:"gender"},{default:l(()=>[o(J,{modelValue:s.user.gender,"onUpdate:modelValue":e[6]||(e[6]=t=>s.user.gender=t),"active-color":"#AAAAAA","inactive-color":"#AAAAAA","inline-prompt":"","active-text":"Male","inactive-text":"Female","active-value":"男","inactive-value":"女"},null,8,["modelValue"])]),_:1}),o(u,{label:"Email",prop:"email"},{default:l(()=>[o(_,{modelValue:s.user.email,"onUpdate:modelValue":e[7]||(e[7]=t=>s.user.email=t),placeholder:"Email",clearable:""},null,8,["modelValue"])]),_:1})]),n("div",Qe,[o(u,{label:"User_id",prop:"id"},{default:l(()=>[o(_,{modelValue:s.user.id,"onUpdate:modelValue":e[8]||(e[8]=t=>s.user.id=t),disabled:""},null,8,["modelValue"])]),_:1}),o(u,{label:"Signature",prop:"description"},{default:l(()=>[o(_,{modelValue:s.user.description,"onUpdate:modelValue":e[9]||(e[9]=t=>s.user.description=t),placeholder:"Signature",autosize:{minRows:1,maxRows:4},type:"textarea"},null,8,["modelValue"])]),_:1}),o(u,{label:"PhoneNumber",prop:"phone_number"},{default:l(()=>[o(_,{modelValue:s.user.phone_number,"onUpdate:modelValue":e[10]||(e[10]=t=>s.user.phone_number=t),placeholder:"PhoneNumber",clearable:""},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model","rules"]),n("span",We,[n("button",{class:"ht-btn ht-btm-md btn--white",onClick:e[11]||(e[11]=(...t)=>i.handleClose&&i.handleClose(...t))},"Cancel"),n("button",{class:"ht-btn ht-btm-md",onClick:e[12]||(e[12]=(...t)=>i.submit&&i.submit(...t))},"Submit")])]),_:1},8,["modelValue","before-close"])]),_:1}),o(x,null,{default:l(()=>[o(C,{title:"新建文件夹",modelValue:s.dialogVisible_new,"onUpdate:modelValue":e[17]||(e[17]=t=>s.dialogVisible_new=t),width:"60%","before-close":i.handleClose_new,draggable:""},{default:l(()=>[o(y,{model:s.new_collection,rules:s.rules_2,ref:"form","label-width":"150px",size:"large"},{default:l(()=>[n("div",Xe,[o(u,{label:"文件夹名字",prop:"name"},{default:l(()=>[o(_,{modelValue:s.new_collection.name,"onUpdate:modelValue":e[14]||(e[14]=t=>s.new_collection.name=t),placeholder:"文件夹名字",clearable:""},null,8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"]),n("span",Ze,[n("button",{class:"ht-btn ht-btm-md btn--white",onClick:e[15]||(e[15]=(...t)=>i.handleClose_new&&i.handleClose_new(...t))},"取消"),n("button",{class:"ht-btn ht-btm-md",onClick:e[16]||(e[16]=(...t)=>i.submit_new&&i.submit_new(...t))},"提交")])]),_:1},8,["modelValue","before-close"])]),_:1}),o(R)])}const Vo=pe(ye,[["render",$e],["__scopeId","data-v-878c5b08"]]);export{Vo as default};
